import{c as k,v as U}from"./package-f741e2b0.js";function O(f){if(!("Notification"in window)){console.error("This browser does not support notifications.");return}Notification.permission==="granted"?new Notification("Notification Title",{body:f,icon:"icon.png"}):Notification.permission!=="denied"&&Notification.requestPermission().then(function(n){n==="granted"&&new Notification("Notification Title",{body:f,icon:"icon.png"})})}O("Hello World");let o=await chrome.storage.local.get(null);o.logs&&console.log("settings",o.solveInSec);function j(){o.apikey&&(async()=>{if(o.power===!1||o.hCap===!1)return;const f=t=>document.querySelector(t);function n(t){console.log("%cnoCaptchaAi.com ~ %c"+t,"background: #222; color: #bada55","")}window.top===window&&n("auto open= ",o.autoOpen+"auto solve= ",o.autoSolve+"loop running in bg");function R(){const t=document.body.getBoundingClientRect();return t?.width===0||t?.height===0?!1:document.querySelector("div.check")!==null}function s(t){return new Promise(a=>setTimeout(a,t))}function q(){try{const t=document.querySelector("div.check");return t&&t.style.display==="block"}catch(t){return console.error(t),!1}}function L(){return!navigator.onLine||v||o.apikey===void 0||""}async function P(t){const a=await(await fetch(t)).blob();return new Promise(function(g){const i=new FileReader;i.readAsDataURL(a),i.addEventListener("loadend",function(){g(i.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),i.addEventListener("error",function(){n("❌ Failed to convert url to base64")})})}const[N]=k((await chrome.storage.local.get("apikey")).apikey),[M,W]=k((await chrome.storage.local.get("plantype")).plantype);k(!0),k(!0);let d="",w="";const S=new URLSearchParams(location.hash);console.log("searchParams",S?.get("sitekey"));const T=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("readystatechange",onXHR),T.apply(this,arguments),console.log("this",T.apply(this,arguments))};async function H(){if(console.log("onXHReady"),!this.responseType!=""){if(!this.responseText)return;this.responseURL.startsWith("https://hcaptcha.com/getcaptcha")?(d=JSON.parse(this.responseText).requester_question?.en,w="en"):this.responseURL.endsWith(`getcaptcha/${S?.get("sitekey")}`)===!0&&(d=JSON.parse(this.responseText).requester_question?.en,w="en",console.log("target xhr",d,w))}}let y,v=!1;const I={"Content-Type":"application/json",apikey:N()};for(;!L();){if(!o.apikey){window.alert("Please enter your apikey");break}await s(1e3);const t=XMLHttpRequest.prototype.open;if(XMLHttpRequest.prototype.open=function(){this.addEventListener("readystatechange",H),t.apply(this,arguments)},o.autoOpen&&R()){if(q()){console.log("found solved");break}await s(100),f("#checkbox")?.click()}else o.autoSolve&&f("h2.prompt-text")!==null&&(o.logs===!0&&n("opening box"),await E())}async function E(){const{target:t,cells:a,images:g}=await _();if(!o.autoSolve)return;y=new Date;const i=new URLSearchParams(location.hash);try{let e=await fetch(X("solve"),{method:"POST",headers:I,body:JSON.stringify({images:g,target:t,method:"hcaptcha_base64",sitekey:i.get("sitekey"),site:i.get("host"),ln:w!==""?"en":document.documentElement.lang||navigator.language,softid:`chrome_extension v${U}`})});if(e=await e.json(),o.logs===!0&&n("sent for solving"),n("🕘 waiting for response"),e.status==="new"){o.logs===!0&&console.table(e),n("waiting 2s"),await s(2e3);const p=await(await fetch(e.url)).json();for(const r of p.solution)a[r].click()}else if(e.status==="solved"){let A=function(c){for(let l=c.length-1;l>0;l--){const m=Math.floor(Math.random()*(l+1));[c[l],c[m]]=[c[m],c[l]]}return c};o.logs===!0&&console.table(e),o.logs===!0&&console.log("noCaptchaAi.com ~ ☑️ server procssed in",e.processing_time),n("🖱️ -> 🖼️");const p=new Date-y,r=o.solveInSec*1e3-p;let b;r>=600?b=(r-300)/e.solution.length:b=150;const C=A(e.solution);for(const c of C){const l=Math.floor(Math.random()*window.innerWidth),m=Math.floor(Math.random()*window.innerHeight),x=document.elementFromPoint(l,m);x&&x.dispatchEvent(new MouseEvent("mousemove",{clientX:l,clientY:m})),a[c].click(),await s(b)}}else{if(e.status==="Unauthorized")return isApikeyEmpty=!0,window.alert("Please enter your apikey"),await s(2e3),n(e.status,e.message);e.error.match("restricted")?(v=!0,window.alert("Your apikey is restricted"),await s(3e3),window.open("https://dash.nocaptchaai.com")):e.error==="Invalid apikey."?(console.log(e.error),window.alert("Invalid apikey"),await s(4e3),v=!0):e.error&&(console.log(e.error),window.alert(e.message),await s(4e3),v=!0)}const h=new Date-y;console.log("elapsedTime",h);const u=o.solveInSec*1e3-h;console.log("solveInSec",o.solveInSec),console.log("remainingTime",u),await s(u),o.logs===!0&&n("waiting random time"),n("☑️ sent!"),document.querySelector(".button-submit").click(),y=0}catch(e){console.error(e)}}function X(t){return"https://"+M()+".nocaptchaai.com/"+t}function _(t=500){return new Promise(async a=>{const g=setInterval(async function(){let i=d||document.querySelector(".prompt-text")?.textContent;if(!i)return;const e=document.querySelectorAll(".task-image .image");if(e.length!==9)return;const h={};for(let u=0;u<e.length;u++){const p=e[u];if(!p)return;const r=p.style.background.match(/url\("(.*)"/)?.at(1)||null;if(!r||r==="")return;h[u]=await P(r)}return clearInterval(g),a({target:i,cells:e,images:h})},t)})}})()}j();
